using UnityEngine;

class Invulnerability : Buff
{
    ActionListener nodmg;
    SpriteRenderer sr;
    public Invulnerability(Unit unit, float duration)
        : base(unit, duration)
    {
        nodmg = new NoDamage();
        unit.eventManager.SubscribeInterceptor("takeDmg", nodmg);
        sr = unit.transform.FindChild("Sprite").GetComponent<SpriteRenderer>();
        sr.color = new Color(sr.color.r, sr.color.g, sr.color.b, 0.5f);
        imagePath = "Buffs/invulnerability";
    }

    public override void End()
    {
        base.End();
        unit.eventManager.UnsubscribeInterceptor("takeDmg", nodmg);
        sr.color = new Color(sr.color.r, sr.color.g, sr.color.b, 1f);
    }

    class NoDamage : ActionListener
    {
        public bool Handle(ActionParams ap)
        {
            ap.forbid = true;
            return false;
        }
    }
}